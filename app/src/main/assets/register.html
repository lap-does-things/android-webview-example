<!DOCTYPE html>
<head>
    <title>Etikot Login</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>

<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script>
    function registerUser() {
    var settings = {
  "async": true,
  "crossDomain": true,
  "url": "https://etikot-3353.restdb.io/rest/users1",
  "method": "GET",
  "headers": {
    "content-type": "application/json",
    "x-apikey": "!!!ВВЕДИ СВОИ ДАННЫЕ УЕБОК!!!",
    "cache-control": "no-cache"
  }
}

$.getJSON(settings).done(function (response) {
    var a=0;
    console.log(response);
if (response.length === 0) {
    console.log('User is not in DB');
    alert('Что-то пошло ужасно не так');
    //отфутболить на логин скрин
    window.location.href = 'login.html';
}
    //console.log(response);
//go through the response and get the username
var exi = false;
for (var i = 0; i < response.length; i++) {
    if (response[i].username === document.getElementById('login').value) {
        console.log('User is in DB');
        alert('Такой пользователь уже существует');
        exi = true;
        break;
        a+=1;
        window.location.href = 'login.html';
        }
    }
    if (exi != true){

                const collection = 'users1';
                const data = {"username": document.getElementById('login').value,
                    "password": document.getElementById('password').value};
var settings = {
  "async": true,
  "crossDomain": true,
  "url": "https://etikot-3353.restdb.io/rest/users1",
  "method": "POST",
  "headers": {
    "content-type": "application/json",
    "x-apikey": "!!!ВВЕДИ СВОИ ДАННЫЕ УЕБОК!!!",
    "cache-control": "no-cache",
  },
  "processData": false,
  "data": JSON.stringify(data)
}

$.ajax(settings).done(function (response) {
    window.location.href = 'login.html';

}).always(function (response) {
  console.log(response);
  window.location.href = 'login.html';
});
    }

}
)



}
</script>
    <link rel="stylesheet" href="style.css">
    <img src="assets/EtikotBG.png" class="bg"> <!-- Login background -->
    <h1 style="color: #29882C;
    text-align: center;"
        >ЭТИКОТ</h1> <!-- Login title -->
    <form>
        <div class="form-group">
            <h3>Логин</h3>
           <!-- <label for="login">Логин</label>-->
            <input type="text" class="form-control"
            id="login" placeholder="">
        </div>
        <div class="form-group">
            <h3>Пароль</h3>
           <!-- <label for="password">Пароль</label>-->
            <input type="password" class="form-control"
            id="password" placeholder=""> <br>
        </div>
        <button type="button" id="register"
        style="margin-top: 10%; margin-bottom: 10%;"
        onclick="registerUser()"
        >РЕГИСТРАЦИЯ</button>
    </form>
  <!--  <form>
        <input type="text" name="login" placeholder="Логин"> <br>
        <input type="password" name="password" placeholder="Пароль"> <br>
        <button type="submit" style="margin-top: 10%;
        margin-bottom: 10%;">ВХОД</button>
    </form>-->


</body>
